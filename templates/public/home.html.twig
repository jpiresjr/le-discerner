{% extends 'public/layout.html.twig' %}

{% block content %}
<!-- Banner Principal (Hero) -->
<header id="hero" class="hero-ipg">
    <div class="hero-ipg__bg"></div>

    <div class="container-lg hero-ipg__content">
        <h1 class="hero-ipg__title">WELCOME</h1>
        <p class="hero-ipg__sub">
            Discover a personalised experience, centred on you. Here, your well-being comes first.
            Connect with qualified, dedicated professionals who genuinely care about you.
        </p>

        <div class="d-flex flex-wrap gap-2 justify-content-center">
            <button type="button" class="btn btn-ipg-cta" data-bs-toggle="modal" data-bs-target="#authModal" data-form="paciente">
                Client
            </button>
            <button type="button" class="btn btn-ipg-outline" data-bs-toggle="modal" data-bs-target="#authModal" data-form="profissional">
                Professional
            </button>
        </div>
    </div>
</header>

<!-- Seção Bem-vindo -->
<section id="bem-vindo" class="welcome-section py-5">
    <div class="container" data-aos="fade-up">
        <div class="welcome-card">
            <span class="welcome-kicker">Nossa essência</span>
            <h2 class="welcome-title">Bem-vindo</h2>
            <div class="welcome-divider"></div>
            <p>A Integrative Psychotherapy Group é uma clínica sediada em Beverly Hills, dedicada a oferecer uma ampla gama de serviços de psicoterapia para indivíduos, casais, famílias e grupos.</p>
            <p>Utilizamos princípios psicodinâmicos contemporâneos para ajudar os clientes a abordar suas preocupações e adotar uma abordagem focada em profundidade na terapia.</p>
            <p>Nosso objetivo é ajudar os clientes a obter insights tanto sobre experiências passadas quanto presentes, a fim de capacitá-los a tomar decisões informadas que levem a mudanças significativas.</p>
        </div>
    </div>
</section>

<!-- Seção Psicoterapia Consciente -->
<section id="psicoterapia-consciente" class="ipg-therapy-section">
    <div class="container" data-aos="fade-up">
        <div class="row align-items-center">

            <!-- CARD (ESQUERDA) -->
            <div class="col-md-6">
                <div class="ipg-therapy-card">

                    <h2 class="ipg-therapy-title">Conscious Psychotherapy</h2>

                    <p class="ipg-therapy-text">
                        We focus on a wide range of therapeutic modalities for those seeking to benefit from psychotherapy:
                    </p>

                    <!-- linha animada -->
                    <div class="ipg-divider" data-aos="divider"></div>

                    <ul class="ipg-therapy-list">
                        <li>Individual</li>
                        <li>Couples</li>
                        <li>Family</li>
                        <li>Group</li>
                    </ul>

                    <a href="#" class="btn btn-ipg-cta mt-3">
                        Schedule a Consultation
                    </a>

                </div>
            </div>

            <!-- IMAGEM (DIREITA) -->
            <div class="col-md-6">
                <div class="ipg-therapy-image">
                    <img src="/images/moca-home.jpeg"
                         alt="Psicoterapia Consciente">
                </div>
            </div>

        </div>
    </div>
</section>

<!-- Seção Abordagem Focada em Profundidade -->
<section id="abordagem-profundidade" class="depth-section">
    <div class="container">
        <div class="depth-card" data-aos="fade-up">
            <h2>
                A Depth-Focused Approach
                <br>
                <small>to Psychotherapy</small>
            </h2>
            <hr class="section-divider">
            <p>
                Our methodology aims to explore deeper insights into the self,
                helping clients make more informed and healthier decisions regarding their present and future.
            </p>
            <p>
                We believe that, through collaborative work between client and therapist,
                meaningful growth is possible.
            </p>
            <a href="#" class="btn btn-ipg-cta mt-3">Learn more</a>
        </div>
    </div>
</section>

<!-- Seção Therapies (Home) -->
<section id="home-therapies" class="py-5">
    <div class="container" data-aos="fade-up">

        <div class="text-center mb-5">
            <h2 class="fw-light">Our Therapeutic Approaches</h2>
            <p class="text-muted">Choose the path that resonates most with you</p>
        </div>

        <div class="row g-4">

            <!-- Psicanálise -->
            <div class="col-md-4">
                <div class="therapy-card">
                    <div class="therapy-card__img" style="background-image:url('/images/Psicanalise.jpeg');"></div>
                    <div class="therapy-card__content">
                        <h5>Psychoanalyst</h5>
                        <a href="/therapies#psicanalise" class="btn btn-ipg-cta w-100">
                            Learn more
                        </a>
                    </div>
                </div>
            </div>

            <!-- Terapia Integrativa -->
            <div class="col-md-4">
                <div class="therapy-card">
                    <div class="therapy-card__img" style="background-image:url('/images/Terapia-integrativa.jpeg');"></div>
                    <div class="therapy-card__content">
                        <h5>Integrative Therapist</h5>
                        <a href="/therapies#terapia-integrativa" class="btn btn-ipg-cta w-100">
                            Learn more
                        </a>
                    </div>
                </div>
            </div>

            <!-- Coaching -->
            <div class="col-md-4">
                <div class="therapy-card">
                    <div class="therapy-card__img" style="background-image:url('/images/Coaching.jpeg');"></div>
                    <div class="therapy-card__content">
                        <h5>Personal Development Coach</h5>
                        <a href="/therapies#coaching" class="btn btn-ipg-cta w-100">
                            Learn more
                        </a>
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>
<section id="profissionais-destaque" class="py-5">
    <div class="container">

        <!-- TÍTULO -->
        <div class="text-center mb-5">
            <h2 class="section-title">Featured Professionals</h2>
            <p class="section-subtitle">
                Carefully selected specialists to support your journey.
            </p>
        </div>

        <!-- CARROSSEL -->
        <div id="carouselProfissionais" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
                {% if featuredProfessionals is not empty %}
                    {% for slide in featuredProfessionals %}
                        <div class="carousel-item {{ loop.first ? 'active' : '' }}">
                            <div class="row g-4 justify-content-center">
                                {% for professional in slide %}
                                    <div class="col-md-6 col-lg-4">
                                        <div class="professional-card h-100">
                                            <div class="professional-image">
                                                <img src="{{ professional.photo }}" alt="Profissional">
                                            </div>
                                            <div class="professional-body">
                                                <h5>{{ professional.name }}</h5>
                                                <span>{{ professional.specialty ?: 'Especialidade não informada' }}</span>
                                                <p>{{ professional.description }}</p>
                                                <a href="/professionals/{{ professional.id }}" class="btn btn-ipg-cta w-100">View profile</a>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="carousel-item active">
                        <div class="row g-4 justify-content-center">
                            <div class="col-12">
                                <div class="alert alert-light text-center">
                                    Nenhum profissional em destaque disponível no momento.
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}

            </div>

            <!-- CONTROLES -->
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselProfissionais" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Anterior</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselProfissionais" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Próximo</span>
            </button>
        </div>
    </div>
</section>

<footer class="bg-theme-dark text-light pt-5 pb-4 home-footer">
    <div class="container">
        <div class="row g-4">
            <div class="col-12 col-md-4">
                <div class="footer-brand">
                    <span class="footer-kicker">Le-Discerner</span>
                    <h5>Integrative Psychotherapy Group</h5>
                    <p>
                        Uma experiência acolhedora e personalizada, conectando você com
                        profissionais qualificados para apoiar sua jornada de bem-estar.
                    </p>
                </div>
            </div>
            <div class="col-6 col-md-2">
                <h5>Institucional</h5>
                <ul class="list-unstyled">
                    <li><a href="/about" class="text-light text-decoration-none">Sobre nós</a></li>
                    <li><a href="/professionals" class="text-light text-decoration-none">Profissionais</a></li>
                    <li><a href="/website-operation" class="text-light text-decoration-none">Como funciona</a></li>
                </ul>
            </div>
            <div class="col-6 col-md-3">
                <h5>Specialty</h5>
                <ul class="list-unstyled">
                    <li><a href="/therapies#psicanalise" class="text-light text-decoration-none">Psicanálise</a></li>
                    <li><a href="/therapies#terapia-integrativa" class="text-light text-decoration-none">Terapia Integrativa</a></li>
                    <li><a href="/therapies#coaching" class="text-light text-decoration-none">Coaching</a></li>
                    <li><a href="/therapies" class="text-light text-decoration-none">Ver todas</a></li>
                </ul>
            </div>
            <div class="col-12 col-md-3">
                <h5>Contato</h5>
                <ul class="list-unstyled footer-contact">
                    <li><i class="bi bi-telephone"></i> +351 913 700 783</li>
                    <li><i class="bi bi-envelope"></i> suporte@suaterapiaon.com</li>
                    <li><i class="bi bi-geo-alt"></i> Barreiro - Setúbal, PT</li>
                </ul>
                <div class="footer-social">
                    <a href="#" class="text-light" aria-label="Instagram">
                            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 24 24">
                                <path d="M 8 3 C 5.239 3 3 5.239 3 8 L 3 16 C 3 18.761 5.239 21 8 21 L 16 21 C 18.761 21 21 18.761 21 16 L 21 8 C 21 5.239 18.761 3 16 3 L 8 3 z M 18 5 C 18.552 5 19 5.448 19 6 C 19 6.552 18.552 7 18 7 C 17.448 7 17 6.552 17 6 C 17 5.448 17.448 5 18 5 z M 12 7 C 14.761 7 17 9.239 17 12 C 17 14.761 14.761 17 12 17 C 9.239 17 7 14.761 7 12 C 7 9.239 9.239 7 12 7 z M 12 9 A 3 3 0 0 0 9 12 A 3 3 0 0 0 12 15 A 3 3 0 0 0 15 12 A 3 3 0 0 0 12 9 z"></path>
                            </svg>
                    </a>
                    <a href="#" class="text-light" aria-label="Facebook">
                        <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 24 24">
                            <path d="M12,2C6.477,2,2,6.477,2,12c0,5.013,3.693,9.153,8.505,9.876V14.65H8.031v-2.629h2.474v-1.749 c0-2.896,1.411-4.167,3.818-4.167c1.153,0,1.762,0.085,2.051,0.124v2.294h-1.642c-1.022,0-1.379,0.969-1.379,2.061v1.437h2.995 l-0.406,2.629h-2.588v7.247C18.235,21.236,22,17.062,22,12C22,6.477,17.523,2,12,2z"></path>
                        </svg>
                    </a>
                    <a href="#" class="text-light" aria-label="X">
                        <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 30 30">
                            <path d="M26.37,26l-8.795-12.822l0.015,0.012L25.52,4h-2.65l-6.46,7.48L11.28,4H4.33l8.211,11.971L12.54,15.97L3.88,26h2.65 l7.182-8.322L19.42,26H26.37z M10.23,6l12.34,18h-2.1L8.12,6H10.23z"></path>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
        <div class="footer-divider"></div>
        <div class="text-center text-secondary small pt-3">
            © 2025 Le-Discerner. Todos os direitos reservados.
        </div>
    </div>
</footer>

<!-- Modal -->
<div class="modal fade" id="authModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
        <div class="modal-content" style="border-radius:16px; overflow:hidden;">
            <div class="modal-header" style="background:rgba(62,69,51,.96); color:#feffff;">
                <h5 class="modal-title" id="authModalTitle">Cadastro</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
            </div>
            <div class="modal-body p-0">
                <div id="authModalBody" class="p-4">
                    <div class="text-center py-5">
                        <div class="spinner-border" role="status" aria-hidden="true"></div>
                        <div class="mt-3">Carregando formulário…</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block inline_javascripts %}
<script>
    AOS.init();

    (() => {
        const nav = document.getElementById('mainNavbar');
        const hero = document.getElementById('hero');
        const bg = document.querySelector('.hero-ipg__bg');
        const content = document.querySelector('.hero-ipg__content');

        function onScroll(){
            const y = window.scrollY || 0;

            // navbar muda ao rolar
            nav.classList.toggle('scrolled', y > 10);

            // parallax (fundo desce mais devagar)
            if (hero && bg){
                const heroH = hero.offsetHeight;
                const p = Math.min(1, y / heroH);
                bg.style.transform = `translateY(${y * 0.25}px) scale(1.06)`;

                // texto dá uma "sumida" leve ao rolar
                if (content){
                    content.style.opacity = (1 - p * 0.55).toFixed(3);
                    content.style.transform = `translateY(${p * 18}px)`;
                }
            }
        }

        window.addEventListener('scroll', onScroll, { passive:true });
        onScroll();
    })();

    (function () {
        const modalEl = document.getElementById('authModal');
        const modalTitle = document.getElementById('authModalTitle');
        const modalBody = document.getElementById('authModalBody');

        const pages = {
            paciente: "/pages/auth/cadastro-paciente.php",
            profissional: "/pages/auth/cadastro-profissional.php"
        };

        function loading(){
            modalBody.innerHTML = `
                <div class="text-center py-5">
                    <div class="spinner-border" role="status" aria-hidden="true"></div>
                    <div class="mt-3">Carregando formulário…</div>
                </div>
            `;
        }

        modalEl.addEventListener('show.bs.modal', async (event) => {
            const btn = event.relatedTarget;
            const type = btn?.getAttribute('data-form') || 'paciente';

            modalTitle.textContent = (type === 'profissional') ? 'Criar Conta — Profissional' : 'Criar Conta — Paciente';

            const url = pages[type];
            if (!url) {
                modalBody.innerHTML = `<div class="alert alert-danger">Página do formulário não configurada.</div>`;
                return;
            }

            try {
                loading();
                const res = await fetch(url, { headers: { "X-Requested-With": "XMLHttpRequest" }});
                const html = await res.text();
                modalBody.innerHTML = html;
            } catch (err) {
                modalBody.innerHTML = `<div class="alert alert-danger">Erro ao carregar o formulário.</div>`;
            }
        });
    })();
</script>
{% endblock %}
